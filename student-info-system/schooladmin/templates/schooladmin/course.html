{% extends 'base.html' %}
{% load static %}
{% load bootstrap3 %}
{% load render_table from django_tables2 %}

{% block title %}{% endblock title %}
{% block header_name %}{% endblock header_name %}

{% block css %}
<link rel="stylesheet" href="{% static 'schooladmin/styles.css' %}">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" />
{% endblock css %}

{% block content %}
<dl class="dl-horizontal">
  <dt>Major</dt>
    <dd><a href="{% url 'schooladmin:major' abbreviation=course.major %}">{{ course.major }}: {{  course.major.name }}</a></dd>
  <dt>Catalog Number</dt>
  <dd>{{ course.catalog_number }}</dd>
  <dt>Title</dt>
  <dd>{{ course.title }}</dd>
  <dt>Description</dt>
  <dd>{{ course.description }}</dd>
  <dt>Credits Earned</dt>
  <dd>{{ course.credits_earned }}</dd>
</dl>

    <div id="Prereqs" class="data-table">
        <h3>Has Prerequisites:</h3>
    {% render_table prereqs 'django_tables2/bootstrap.html' %}
    </div>

        <h3>Is Prerequisite For:</h3>
    <div id="IsPrereq" class="data-table">
        {% render_table needed_by 'django_tables2/bootstrap.html' %}
    </div>

        <h3>Sections:</h3>
    <div id="Sections">
        {% if filter %}
            <form id="myfilt" action="" method="get" class="form form-inline" autocomplete="off">
            {% bootstrap_form filter.form layout='inline' %}
            <button class="btn btn-primary">Filter</button>
            {% if has_filter %}
              <a  class="btn btn-success" href="{%  url 'schooladmin:sections' %}">Clear</a>
            {% endif %}
            </form>
        {% endif %}
    <div class="data-table-alt">
        {% render_table sections 'django_tables2/bootstrap.html' %}
    </div>
    </div>

    <input
        action="action"
           class="btn btn-info"
        onclick="window.history.go(-1); return false;"
        value="Back"
    />
     <input id="new_section"
        action="action"
           class="btn btn-info"
        value="New Section"
    />
     <input id="course_edit"
        action="action"
           class="btn btn-info"
        value="Edit Course"
    />
<script>
function edit_course(evt) {
    var url = "{% url 'schooladmin:course_edit' courseid=course.id %}";
    open(url,'_self');
    return false;
}

function new_section(evt) {
    var url = "{% url 'schooladmin:course_section_new' courseid=course.id %}";
    open(url,'_self');
    return false;
}

function selectSection(evt) {
    var id = this.getAttribute('data-id');
    var url = "{% url 'schooladmin:section' sectionid=1234599 %}".replace(/1234599/, id.toString());
    open(url,'_self');
}

function selectCourse(evt) {
    var id = this.getAttribute('data-id');
    var url = "{% url 'schooladmin:course' courseid=1234599 %}".replace(/1234599/, id.toString());
    open(url,'_self');
}

var tablerows = document.getElementsByClassName('section_row')
for (var i=0, len=tablerows.length; i<len; i=i+1) {
    tablerows[i].addEventListener("click", selectSection, false);
}

// Add onclick to each row so that it leaps off to the detail
var tablerows = document.getElementsByClassName('course_row')
for (var i=0, len=tablerows.length; i<len; i=i+1) {
    tablerows[i].addEventListener("click", selectCourse, false);
}

btn = document.getElementById("course_edit");
if ( btn ) {
    btn.addEventListener("click", edit_course);
}
btn = document.getElementById("new_section");
if ( btn ) {
    btn.addEventListener("click", new_section);
}
</script>
{% endblock %}
