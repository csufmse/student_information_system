{% extends 'sis/subpage_base.html' %}
{% load static %}
{% load bootstrap3 %}
{% load render_table from django_tables2 %}

{% block content %}
<dl class="dl-horizontal">
  <dt>Professor</dt>
  <dd>{{ user.name }}</dd>
  <dt>Professor Name</dt>
  <dd>{{ user.username }}</dd>
  <dt>Email</dt>
  <dd>{{ user.email }}</dd>
  <dt>Professor Type</dt>
  <dd>{{ user.access_role }}</dd>
  <dt>Teaching Department</dt>
  <dd><a href="{% url 'schooladmin:major' majorid=user.profile.professor.major.id %}">{{ user.profile.professor.major.abbreviation }}: {{  user.profile.professor.major.name }}</a></dd>
  <dt>Enabled?</dt>
  <dd>{% if user.is_active %}Enabled{% else %}Disabled{% endif %}</dd>
</dl>
        <h3>Received Messages:</h3>
    <div id="received">
        {% if received_filter %}
            <form id="received_filter" action="" method="get" class="form form-inline" autocomplete="off">
                {% bootstrap_form received_filter.form layout='inline' %}
                <button class="btn btn-primary">Filter</button>
                {% if received_has_filter %}
                    <a  class="btn btn-success" href="{%  url 'schooladmin:user' userid=user.id %}">Clear</a>
                {% endif %}
            </form>
        {% endif %}
        <div class="data-table-alt">
            {% render_table received_table 'django_tables2/bootstrap.html' %}
        </div>
    </div>

        <h3>Sent Messages:</h3>
    <div id="sent">
        {% if sent_filter %}
            <form id="sent_filter" action="" method="get" class="form form-inline" autocomplete="off">
                {% bootstrap_form sent_filter.form layout='inline' %}
                <button class="btn btn-primary">Filter</button>
                {% if sent_has_filter %}
                    <a  class="btn btn-success" href="{%  url 'schooladmin:user' userid=user.id %}">Clear</a>
                {% endif %}
            </form>
        {% endif %}
        <div class="data-table-alt">
            {% render_table sent_table 'django_tables2/bootstrap.html' %}
        </div>
    </div>

    <h3>Semesters Taught</h3>
    <div id="semesterstaught">
        {% if semesters_filter %}
            <form id="semesters_filter" action="" method="get" class="form form-inline" autocomplete="off">
                {% bootstrap_form semesters_filter.form layout='inline' %}
                <button class="btn btn-primary">Filter</button>
                {% if semesters_has_filter %}
                    <a  class="btn btn-success" href="{%  url 'schooladmin:user' userid=user.id %}">Clear</a>
                {% endif %}
            </form>
        {% endif %}
        <div class="data-table-alt">
            {% render_table semesters_table 'django_tables2/bootstrap.html' %}
        </div>
    </div>

    <h3>Sections Taught</h3>
    <div id="sectionstaught">
        {% if sections_filter %}
            <form id="sections_filter" action="" method="get" class="form form-inline" autocomplete="off">
                {% bootstrap_form sections_filter.form layout='inline' %}
                <button class="btn btn-primary">Filter</button>
                {% if sections_has_filter %}
                    <a  class="btn btn-success" href="{%  url 'schooladmin:user' userid=user.id %}">Clear</a>
                {% endif %}
            </form>
        {% endif %}
        <div class="data-table-alt">
            {% render_table sections_table 'django_tables2/bootstrap.html' %}
        </div>
    </div>

    <h3>Reference Items for Courses</h3>
    <div id="items">
        {% if items_filter %}
            <form id="items_filter" action="" method="get" class="form form-inline" autocomplete="off">
                {% bootstrap_form items_filter.form layout='inline' %}
                <button class="btn btn-primary">Filter</button>
                {% if items_has_filter %}
                    <a  class="btn btn-success" href="{%  url 'schooladmin:user' userid=user.id %}">Clear</a>
                {% endif %}
            </form>
        {% endif %}
        <div class="data-table-alt">
            {% render_table items_table 'django_tables2/bootstrap.html' %}
        </div>
    </div>

  <form method="post">
    {% csrf_token %}
     <input type="hidden" name="userid" value="{{ user.id }}"/>
    <input
        action="action"
           class="btn btn-info"
        onclick="window.history.go(-1); return false;"
        value="Back"
    />
    <input id="change_password"
        action="action"
           class="btn btn-info"
        value="Change Password"
    />
      {% if user.is_active %}
    <input id="disbutton" name="disbutton"
           class="btn btn-primary"
           action="action"
        value="Disable Professor"
    />
    {% else %}
    <input id="enabutton" name="enabutton"
        action="action"
           class="btn btn-primary"
        value="Enable Professor"
   />
   {% endif %}
     <input id="showitems"
        action="action"
           class="btn btn-info"
        value="Reference Items"
    />
     <input id="new_item"
        action="action"
           class="btn btn-info"
        value="Add Reference Item"
    />
     <input id="edit_professor"
        action="action"
           class="btn btn-info"
        value="Edit Professor"
    />

  </form>
<script>
function confirmit(evt) {
    var btntitle = evt.target.value;
    var answer = window.confirm("Are you sure you want to "+btntitle+' \n"{{ user.username }}" ({{ user.get_full_name  }})');
    if (answer) {
        this.form.submit();
        return true;
    }
    return false;
}
var btn = document.getElementById("disbutton");
if ( btn ) {
    btn.addEventListener("click", confirmit);
}
btn = document.getElementById("enabutton");
if ( btn ) {
    btn.addEventListener("click", confirmit);
}
addButtonClickHandler('new_item', "{% url 'schooladmin:professor_item_new' userid=user.id %}");
addButtonClickHandler('change_password', "{% url 'schooladmin:change_password' user.id %}");
addButtonClickHandler('edit_professor', "{% url 'schooladmin:user_edit' user.id %}");
addButtonClickHandler('showitems', "{% url 'schooladmin:professor_items' user.id %}");
addClickHandlers("{% url 'schooladmin:semester' semester_id=1234599 %}", "semester_row");
addClickHandlers("{% url 'schooladmin:section' sectionid=1234599 %}", "section_row");
addClickHandlers("{% url 'schooladmin:professor_item' userid=user.id item_id=1234599 %}", "refitem_row");
</script>
{% endblock %}
